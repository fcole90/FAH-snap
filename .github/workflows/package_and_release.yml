
on:
  push:
    branches:
      - master
  pull_request:
    branches: [master]
    types: [opened, synchronize]
  # schedule:
  # # * is a special character in YAML so you have to quote this string
  # # - cron:  '0 0 */15 * *'
  # - cron:  '*/5 * * * *'

jobs:
  prJob:
    name: Print info
    runs-on: ubuntu-latest
    steps:
      - name: Print GitHub event action
        run: |
          echo "${{toJSON(github.event_name)}}"
          echo "${{toJSON(github.event_name == 'schedule')}}"
    
      - name: Install Review Tools Snap
        run: sudo snap install review-tools
      
      - name: Download snap
        run: snap download folding-at-home-fcole90
        # if: ${{ github.event_name == 'schedule' }}
      
      - name: Check Vulnerabilities
        run: review-tools.check-notices folding-at-home-fcole90*.snap --with-cves > cves.json

      - name: Checks
        run: |
          echo "${{ env.cves }}"
          echo "${{ env.cves.folding-at-home-fcole90 }}"

  # packaging_snap:
  #   runs-on: ubuntu-18.04
  #   steps:
  #     - uses: actions/checkout@v2

  #     - name: Install LXD
  #       run: sudo snap install lxd
      
  #     - name: Configure LXD
  #       run: |
  #         sudo usermod --append --groups lxd $USER
  #         sudo /snap/bin/lxd.migrate -yes
  #         sudo /snap/bin/lxd waitready
  #         sudo /snap/bin/lxd init --auto
          
  #     - name: Install Snapcraft in LXD
  #       run: sg lxd -c "sudo snap install snapcraft --classic"
      
  #     - name: Build Snap
  #       run: sg lxd -c "sudo snapcraft --use-lxd"
      
  #     - name: Check Files
  #       run: ls
      
  #     - name: Snap Store Login
  #       run: |
  #         echo ${{ secrets.SNAP_TOKEN }} | snapcraft login --with -
  #         snapcraft whoami

  #     - name: Snap Store Release
  #       run: sudo snapcraft upload --release=stable folding-at-home-fcole90_*.snap